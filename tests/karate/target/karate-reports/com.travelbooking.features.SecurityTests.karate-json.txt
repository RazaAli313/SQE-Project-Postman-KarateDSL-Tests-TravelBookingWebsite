{"failedCount":3,"prefixedPath":"classpath:com\/travelbooking\/features\/SecurityTests.feature","packageQualifiedName":"com.travelbooking.features.SecurityTests","loopIndex":-1,"relativePath":"com\/travelbooking\/features\/SecurityTests.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":480376,"millis":0.480376,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def baseUrl = 'http:\/\/localhost:3000\/api\/v1'"}},{"result":{"nanos":181674,"millis":0.181674,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"url baseUrl"}},{"result":{"nanos":546064,"millis":0.546064,"status":"passed"},"step":{"line":8,"prefix":"Given","index":0,"text":"path 'users\/login'"}},{"result":{"nanos":307222,"millis":0.307222,"status":"passed"},"step":{"line":9,"prefix":"And","index":1,"text":"request { email: \"' OR '1'='1\", password: \"' OR '1'='1\" }"}},{"result":{"nanos":145874454,"millis":145.874454,"status":"passed"},"step":{"line":10,"prefix":"When","index":2,"text":"method POST"},"stepLog":"17:59:42.485 request:\n1 > POST http:\/\/localhost:3000\/api\/v1\/users\/login\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 48\n1 > Host: localhost:3000\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.17)\n1 > Accept-Encoding: gzip,deflate\n{\"email\":\"' OR '1'='1\",\"password\":\"' OR '1'='1\"}\n\n17:59:42.628 response time in milliseconds: 142\n1 < 404\n1 < X-Powered-By: Express\n1 < Vary: Origin\n1 < Access-Control-Allow-Credentials: true\n1 < Content-Type: application\/json; charset=utf-8\n1 < Content-Length: 78\n1 < ETag: W\/\"4e-g9o3TPbWGOSW5TBIr7g2ajrX7d0\"\n1 < Date: Sun, 14 Dec 2025 12:59:42 GMT\n1 < Connection: keep-alive\n1 < Keep-Alive: timeout=5\n{\"status\":\"error\",\"message\":\"Invalid credentials\",\"errors\":[\"User not found\"]}\n\n"},{"result":{"nanos":127593,"errorMessage":"status code was: 404, expected: 401, response time in milliseconds: 142, url: http:\/\/localhost:3000\/api\/v1\/users\/login, response: \n{\"status\":\"error\",\"message\":\"Invalid credentials\",\"errors\":[\"User not found\"]}\nclasspath:com\/travelbooking\/features\/SecurityTests.feature:11","millis":0.127593,"status":"failed"},"step":{"line":11,"prefix":"Then","index":3,"text":"status 401"},"stepLog":"17:59:42.629 classpath:com\/travelbooking\/features\/SecurityTests.feature:11\nThen status 401\nstatus code was: 404, expected: 401, response time in milliseconds: 142, url: http:\/\/localhost:3000\/api\/v1\/users\/login, response: \n{\"status\":\"error\",\"message\":\"Invalid credentials\",\"errors\":[\"User not found\"]}\nclasspath:com\/travelbooking\/features\/SecurityTests.feature:11\n"}],"line":7,"description":"","durationMillis":147.517383,"failed":true,"error":"status code was: 404, expected: 401, response time in milliseconds: 142, url: http:\/\/localhost:3000\/api\/v1\/users\/login, response: \n{\"status\":\"error\",\"message\":\"Invalid credentials\",\"errors\":[\"User not found\"]}\nclasspath:com\/travelbooking\/features\/SecurityTests.feature:11","executorName":"main","name":"SQL Injection attempt in login","startTime":1765717182481,"refId":"[1:7]","endTime":1765717182629,"exampleIndex":-1},{"sectionIndex":1,"stepResults":[{"result":{"nanos":283553,"millis":0.283553,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def baseUrl = 'http:\/\/localhost:3000\/api\/v1'"}},{"result":{"nanos":109526,"millis":0.109526,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"url baseUrl"}},{"result":{"nanos":1018856,"millis":1.018856,"status":"passed"},"step":{"line":14,"prefix":"*","index":0,"text":"def xssTimestamp = new java.util.Date().getTime()"}},{"result":{"nanos":2596756,"millis":2.596756,"status":"passed"},"step":{"line":15,"prefix":"*","index":1,"text":"def xssEmail = 'xss' + xssTimestamp.toString() + '@example.com'"}},{"result":{"nanos":68286,"millis":0.068286,"status":"passed"},"step":{"line":16,"prefix":"Given","index":2,"text":"path 'users\/register'"}},{"result":{"nanos":277934,"millis":0.277934,"status":"passed"},"step":{"line":17,"prefix":"And","index":3,"text":"request { fullname: '<script>alert(\"XSS\")<\/script>', email: xssEmail, password: 'Test@123456' }"}},{"result":{"nanos":134827112,"millis":134.827112,"status":"passed"},"step":{"line":18,"prefix":"When","index":4,"text":"method POST"},"stepLog":"17:59:42.647 request:\n1 > POST http:\/\/localhost:3000\/api\/v1\/users\/register\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 91\n1 > Host: localhost:3000\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.17)\n1 > Accept-Encoding: gzip,deflate\n{\"fullname\":\"<script>alert(\\\"XSS\\\")<\\\/script>\",\"email\":\"xssEmail\",\"password\":\"Test@123456\"}\n\n17:59:42.778 response time in milliseconds: 130\n1 < 500\n1 < X-Powered-By: Express\n1 < Vary: Origin\n1 < Access-Control-Allow-Credentials: true\n1 < Content-Type: application\/json; charset=utf-8\n1 < Content-Length: 135\n1 < ETag: W\/\"87-d+ngQweWPXbYQJTFC0\/+lAtAd4U\"\n1 < Date: Sun, 14 Dec 2025 12:59:42 GMT\n1 < Connection: keep-alive\n1 < Keep-Alive: timeout=5\n{\"status\":\"error\",\"message\":\"Failed to register user\",\"errors\":[\"User validation failed: email: Please provide a valid email address\"]}\n\n"},{"result":{"nanos":107963,"errorMessage":"status code was: 500, expected: 201, response time in milliseconds: 130, url: http:\/\/localhost:3000\/api\/v1\/users\/register, response: \n{\"status\":\"error\",\"message\":\"Failed to register user\",\"errors\":[\"User validation failed: email: Please provide a valid email address\"]}\nclasspath:com\/travelbooking\/features\/SecurityTests.feature:19","millis":0.107963,"status":"failed"},"step":{"line":19,"prefix":"Then","index":5,"text":"status 201"},"stepLog":"17:59:42.780 classpath:com\/travelbooking\/features\/SecurityTests.feature:19\nThen status 201\nstatus code was: 500, expected: 201, response time in milliseconds: 130, url: http:\/\/localhost:3000\/api\/v1\/users\/register, response: \n{\"status\":\"error\",\"message\":\"Failed to register user\",\"errors\":[\"User validation failed: email: Please provide a valid email address\"]}\nclasspath:com\/travelbooking\/features\/SecurityTests.feature:19\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# Verify input is sanitized (should not contain script tags in response)"],"line":21,"prefix":"And","index":6,"text":"match response.data.fullname != '<script>alert(\"XSS\")<\/script>'"}}],"line":13,"description":"","durationMillis":139.289986,"failed":true,"error":"status code was: 500, expected: 201, response time in milliseconds: 130, url: http:\/\/localhost:3000\/api\/v1\/users\/register, response: \n{\"status\":\"error\",\"message\":\"Failed to register user\",\"errors\":[\"User validation failed: email: Please provide a valid email address\"]}\nclasspath:com\/travelbooking\/features\/SecurityTests.feature:19","executorName":"main","name":"XSS attempt in registration","startTime":1765717182638,"refId":"[2:13]","endTime":1765717182780,"exampleIndex":-1},{"sectionIndex":2,"stepResults":[{"result":{"nanos":246037,"millis":0.246037,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def baseUrl = 'http:\/\/localhost:3000\/api\/v1'"}},{"result":{"nanos":100408,"millis":0.100408,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"url baseUrl"}},{"result":{"nanos":570234,"millis":0.570234,"status":"passed"},"step":{"line":24,"prefix":"Given","index":0,"text":"path 'users\/update-password'"}},{"result":{"nanos":1831277,"millis":1.831277,"status":"passed"},"step":{"line":25,"prefix":"And","index":1,"text":"request { oldPassword: 'Test@123456', newPassword: 'NewTest@123456' }"}},{"result":{"nanos":7150972,"millis":7.150972,"status":"passed"},"step":{"line":26,"prefix":"When","index":2,"text":"method PUT"},"stepLog":"17:59:42.793 request:\n1 > PUT http:\/\/localhost:3000\/api\/v1\/users\/update-password\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 60\n1 > Host: localhost:3000\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.17)\n1 > Accept-Encoding: gzip,deflate\n{\"oldPassword\":\"Test@123456\",\"newPassword\":\"NewTest@123456\"}\n\n17:59:42.798 response time in milliseconds: 5\n1 < 401\n1 < X-Powered-By: Express\n1 < Vary: Origin\n1 < Access-Control-Allow-Credentials: true\n1 < Content-Type: application\/json; charset=utf-8\n1 < Content-Length: 85\n1 < ETag: W\/\"55-xtRwqy\/to2gB\/FDHJYhC19EVdRo\"\n1 < Date: Sun, 14 Dec 2025 12:59:42 GMT\n1 < Connection: keep-alive\n1 < Keep-Alive: timeout=5\n{\"status\":\"error\",\"message\":\"Unauthorized\",\"errors\":[\"Authentication token missing\"]}\n\n"},{"result":{"nanos":10319,"millis":0.010319,"status":"passed"},"step":{"line":27,"prefix":"Then","index":3,"text":"status 401"}}],"executorName":"main","line":23,"name":"Access protected endpoint without token","description":"","durationMillis":9.909247,"startTime":1765717182789,"failed":false,"refId":"[3:23]","endTime":1765717182799,"exampleIndex":-1},{"sectionIndex":3,"stepResults":[{"result":{"nanos":185499,"millis":0.185499,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def baseUrl = 'http:\/\/localhost:3000\/api\/v1'"}},{"result":{"nanos":60450,"millis":0.06045,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"url baseUrl"}},{"result":{"nanos":858388,"millis":0.858388,"status":"passed"},"step":{"line":30,"prefix":"*","index":0,"text":"def userTimestamp = new java.util.Date().getTime()"}},{"result":{"nanos":303850,"millis":0.30385,"status":"passed"},"step":{"line":31,"prefix":"*","index":1,"text":"def userEmail = 'user' + userTimestamp.toString() + '@example.com'"}},{"result":{"nanos":35697,"millis":0.035697,"status":"passed"},"step":{"line":32,"prefix":"Given","index":2,"text":"path 'users\/register'"}},{"result":{"nanos":198794,"millis":0.198794,"status":"passed"},"step":{"line":33,"prefix":"And","index":3,"text":"request { fullname: 'Regular User', email: userEmail, password: 'User@123456', isVerified: true }"}},{"result":{"nanos":134480146,"millis":134.480146,"status":"passed"},"step":{"line":34,"prefix":"When","index":4,"text":"method POST"},"stepLog":"17:59:42.813 request:\n1 > POST http:\/\/localhost:3000\/api\/v1\/users\/register\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 90\n1 > Host: localhost:3000\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.17)\n1 > Accept-Encoding: gzip,deflate\n{\"fullname\":\"Regular User\",\"email\":\"userEmail\",\"password\":\"User@123456\",\"isVerified\":true}\n\n17:59:42.943 response time in milliseconds: 129\n1 < 500\n1 < X-Powered-By: Express\n1 < Vary: Origin\n1 < Access-Control-Allow-Credentials: true\n1 < Content-Type: application\/json; charset=utf-8\n1 < Content-Length: 135\n1 < ETag: W\/\"87-d+ngQweWPXbYQJTFC0\/+lAtAd4U\"\n1 < Date: Sun, 14 Dec 2025 12:59:42 GMT\n1 < Connection: keep-alive\n1 < Keep-Alive: timeout=5\n{\"status\":\"error\",\"message\":\"Failed to register user\",\"errors\":[\"User validation failed: email: Please provide a valid email address\"]}\n\n"},{"result":{"nanos":124989,"errorMessage":"status code was: 500, expected: 201, response time in milliseconds: 129, url: http:\/\/localhost:3000\/api\/v1\/users\/register, response: \n{\"status\":\"error\",\"message\":\"Failed to register user\",\"errors\":[\"User validation failed: email: Please provide a valid email address\"]}\nclasspath:com\/travelbooking\/features\/SecurityTests.feature:35","millis":0.124989,"status":"failed"},"step":{"line":35,"prefix":"Then","index":5,"text":"status 201"},"stepLog":"17:59:42.945 classpath:com\/travelbooking\/features\/SecurityTests.feature:35\nThen status 201\nstatus code was: 500, expected: 201, response time in milliseconds: 129, url: http:\/\/localhost:3000\/api\/v1\/users\/register, response: \n{\"status\":\"error\",\"message\":\"Failed to register user\",\"errors\":[\"User validation failed: email: Please provide a valid email address\"]}\nclasspath:com\/travelbooking\/features\/SecurityTests.feature:35\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":36,"prefix":"Given","index":6,"text":"path 'users\/login'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":37,"prefix":"And","index":7,"text":"request { email: userEmail, password: 'User@123456' }"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":38,"prefix":"When","index":8,"text":"method POST"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":39,"prefix":"*","index":9,"text":"def userToken = response.data.token || ''"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":40,"prefix":"Given","index":10,"text":"path 'flights'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":41,"prefix":"And","index":11,"text":"header Authorization = 'Bearer ' + userToken"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":42,"prefix":"And","index":12,"text":"request { flights: [{ airline: 'Test Airlines', from: 'New York', to: 'London', departureDate: '2024-12-25', arrivalDate: '2024-12-25', price: 500, availableSeats: 100 }] }"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":43,"prefix":"When","index":13,"text":"method POST"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":44,"prefix":"Then","index":14,"text":"status 403"}}],"line":29,"description":"","durationMillis":136.247813,"failed":true,"error":"status code was: 500, expected: 201, response time in milliseconds: 129, url: http:\/\/localhost:3000\/api\/v1\/users\/register, response: \n{\"status\":\"error\",\"message\":\"Failed to register user\",\"errors\":[\"User validation failed: email: Please provide a valid email address\"]}\nclasspath:com\/travelbooking\/features\/SecurityTests.feature:35","executorName":"main","name":"Access admin endpoint as regular user","startTime":1765717182808,"refId":"[4:29]","endTime":1765717182945,"exampleIndex":-1},{"sectionIndex":4,"stepResults":[{"result":{"nanos":290370,"millis":0.29037,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def baseUrl = 'http:\/\/localhost:3000\/api\/v1'"}},{"result":{"nanos":102692,"millis":0.102692,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"url baseUrl"}},{"result":{"nanos":64951,"millis":0.064951,"status":"passed"},"step":{"line":47,"prefix":"Given","index":0,"text":"path 'users\/update-password'"}},{"result":{"nanos":1473941,"millis":1.473941,"status":"passed"},"step":{"line":48,"prefix":"And","index":1,"text":"header Authorization = 'Bearer invalid_token_12345'"}},{"result":{"nanos":364291,"millis":0.364291,"status":"passed"},"step":{"line":49,"prefix":"And","index":2,"text":"request { oldPassword: 'Test@123456', newPassword: 'NewTest@123456' }"}},{"result":{"nanos":8651757,"millis":8.651757,"status":"passed"},"step":{"line":50,"prefix":"When","index":3,"text":"method PUT"},"stepLog":"17:59:42.962 request:\n1 > PUT http:\/\/localhost:3000\/api\/v1\/users\/update-password\n1 > Authorization: Bearer invalid_token_12345\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 60\n1 > Host: localhost:3000\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.17)\n1 > Accept-Encoding: gzip,deflate\n{\"oldPassword\":\"Test@123456\",\"newPassword\":\"NewTest@123456\"}\n\n17:59:42.966 response time in milliseconds: 3\n1 < 401\n1 < X-Powered-By: Express\n1 < Vary: Origin\n1 < Access-Control-Allow-Credentials: true\n1 < Content-Type: application\/json; charset=utf-8\n1 < Content-Length: 70\n1 < ETag: W\/\"46-Tw6QAp9IgeGr\/OH+qPPyZ1I9k5s\"\n1 < Date: Sun, 14 Dec 2025 12:59:42 GMT\n1 < Connection: keep-alive\n1 < Keep-Alive: timeout=5\n{\"status\":\"error\",\"message\":\"Unauthorized\",\"errors\":[\"jwt malformed\"]}\n\n"},{"result":{"nanos":13248,"millis":0.013248,"status":"passed"},"step":{"line":51,"prefix":"Then","index":4,"text":"status 401"}}],"executorName":"main","line":46,"name":"Invalid JWT token","description":"","durationMillis":10.96125,"startTime":1765717182957,"failed":false,"refId":"[5:46]","endTime":1765717182968,"exampleIndex":-1}],"callDepth":0,"name":"Security Tests","description":"","resultDate":"2025-12-14 05:59:42 pm","durationMillis":443.925679,"passedCount":2}